<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Red Cross Youth AI Photo Booth - Fiesta 2025</title>
    <meta name="description" content="AI Face Swap Photo Booth for Red Cross Youth Fiesta 2025">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23dc2626'/><text y='50' x='50' text-anchor='middle' dominant-baseline='middle' font-size='60' fill='white'>+</text></svg>">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23dc2626'/><text y='50' x='50' text-anchor='middle' dominant-baseline='middle' font-size='60' fill='white'>+</text></svg>">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="red-cross-logo">+</div>
                <div class="title">
                    <h1>Red Cross Youth</h1>
                    <p>AI Photo Booth - Fiesta 2025</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
            <div class="welcome-content">
                <div class="welcome-hero">
                    <div class="hero-icon">üì∏</div>
                    <h2>Welcome to the AI Face Swap Experience!</h2>
                    <p>Transform yourself into your favorite characters using AI technology</p>
                </div>
                <div class="features-grid">
                    <div class="feature">
                        <div class="feature-icon">ü§ñ</div>
                        <h3>AI-Powered</h3>
                        <p>Advanced face detection and swapping</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">üë•</div>
                        <h3>Group Photos</h3>
                        <p>Multiple faces automatically detected</p>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">üì±</div>
                        <h3>Instant Share</h3>
                        <p>Download, email, or print instantly</p>
                    </div>
                </div>
                <button id="start-btn" class="btn btn-primary btn-large">
                    Start Photo Booth
                    <span class="btn-icon">‚ñ∂</span>
                </button>
            </div>
        </div>

        <!-- Camera Screen -->
        <div id="camera-screen" class="screen">
            <div class="camera-container">
                <!-- Camera Controls -->
                <div class="camera-controls">
                    <button id="switch-camera-btn" class="btn btn-icon" title="Switch Camera">
                        üîÑ
                    </button>
                    <button id="back-to-welcome-btn" class="btn btn-icon" title="Back">
                        ‚Üê
                    </button>
                </div>

                <!-- Video Preview -->
                <div class="video-container">
                    <video id="video" autoplay muted playsinline></video>
                    <canvas id="overlay-canvas"></canvas>
                    <div id="face-detection-overlay"></div>
                </div>

                <!-- Template Selection -->
                <div class="template-section">
                    <h3>Choose Your Character</h3>
                    
                    <!-- Custom Upload Option -->
                    <div class="upload-section">
                        <label for="custom-image-upload" class="upload-btn btn btn-secondary">
                            <span class="btn-icon">üìÅ</span>
                            Upload Your Own Image
                        </label>
                        <input type="file" id="custom-image-upload" accept="image/*" style="display: none;">
                        <p class="upload-hint">Upload a face photo for realistic face swapping!</p>
                    </div>
                    
                    <div class="template-grid" id="template-grid">
                        <!-- Templates will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Capture Controls -->
                <div class="capture-controls">
                    <div class="capture-info">
                        <p id="instruction-text">Select a character template above, then click capture!</p>
                    </div>
                    <button id="capture-btn" class="btn btn-primary btn-large" disabled>
                        <span class="btn-icon">üì∏</span>
                        Capture Photo
                    </button>
                </div>
            </div>
        </div>

        <!-- Countdown Screen -->
        <div id="countdown-screen" class="screen">
            <div class="countdown-container">
                <div class="countdown-circle">
                    <div id="countdown-number">3</div>
                </div>
                <p>Get ready! Look at the camera</p>
                <button id="cancel-countdown-btn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>

        <!-- Processing Screen -->
        <div id="processing-screen" class="screen">
            <div class="processing-container">
                <div class="processing-animation">
                    <div class="loading-spinner"></div>
                    <div class="ai-brain">üß†</div>
                </div>
                <h3>AI Processing...</h3>
                <p id="processing-status">Detecting faces and applying magic ‚ú®</p>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="screen">
            <div class="result-container">
                <div class="result-header">
                    <h3>Your AI Face Swap Result!</h3>
                    <p>Red Cross Youth Fiesta 2025</p>
                </div>
                
                <div class="result-image-container">
                    <canvas id="result-canvas"></canvas>
                </div>

                <div class="result-actions">
                    <div class="primary-actions">
                        <button id="download-btn" class="btn btn-primary">
                            <span class="btn-icon">‚¨á</span>
                            Download
                        </button>
                        <button id="share-btn" class="btn btn-primary">
                            <span class="btn-icon">üì§</span>
                            Share
                        </button>
                        <button id="print-btn" class="btn btn-primary">
                            <span class="btn-icon">üñ®</span>
                            Print
                        </button>
                    </div>
                    <div class="secondary-actions">
                        <button id="email-btn" class="btn btn-secondary">
                            <span class="btn-icon">üìß</span>
                            Email
                        </button>
                        <button id="qr-btn" class="btn btn-secondary">
                            <span class="btn-icon">üì±</span>
                            QR Code
                        </button>
                        <button id="retake-btn" class="btn btn-secondary">
                            <span class="btn-icon">üîÑ</span>
                            Take Another
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Error Screen -->
        <div id="error-screen" class="screen">
            <div class="error-container">
                <div class="error-icon">‚ö†Ô∏è</div>
                <h3 id="error-title">Something went wrong</h3>
                <p id="error-message">Please try again or check your camera permissions.</p>
                <div class="error-actions">
                    <button id="retry-btn" class="btn btn-primary">Try Again</button>
                    <button id="back-to-start-btn" class="btn btn-secondary">Back to Start</button>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Modal -->
    <div id="qr-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Scan to Download</h3>
                <button id="close-qr-modal" class="btn btn-icon">√ó</button>
            </div>
            <div class="modal-body">
                <div id="qr-code-container"></div>
                <p>Scan this QR code with your phone to download the image</p>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>Loading AI models...</p>
        </div>
    </div>

    <!-- Hidden Canvas for Processing -->
    <canvas id="processing-canvas" style="display: none;"></canvas>
    <canvas id="temp-canvas" style="display: none;"></canvas>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-delaunay@6.0.2/dist/d3-delaunay.min.js"></script>
    <script src="app.js"></script>
</body>
</html>